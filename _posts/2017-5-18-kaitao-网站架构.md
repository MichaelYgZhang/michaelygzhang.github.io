---
layout: post
title: 亿级流量网站架构核心技术----读书笔记
excerpt: 亿级流量网站架构核心技术----读书笔记
category: Destributed
---


#### 第一部分 概述

- 高可用原则
  1. 降级
      - 开关集中化管理
      - 可降级的多级读服务
      - 开关前置化
      - 业务降级
  2. 限流
      - 恶意请求流量只访问到cache
      - 对于穿透到后端应用的流量可以考虑用Nginx的limit模块处理
      - 对于恶意IP可以使用nginx deny进行屏蔽
  3. 切流量
      - DNS切换机房入口
      - HttpDNS
      - LVS/HaProxy
      - Nginx
  4. 可回滚

- 业务设计原则
  1. 防重设计
  2. 幂等设计
  3. 流程可定义
  4. 状态与状态机，正向状态和逆向状态
  5. 后台系统操作可反馈
  6. 后台系统审批化
  7. 文档和注释
  8. 备份

#### 第2部分 高可用

- 负载均衡与反向代理   TODO 未看完，后期可以边看nginx源码边了解这里
  1. 负载均衡算法
    - 轮询默认
    - ip_hash
    - hash_key 一致性哈希
    - 哈希算法
  2. 失败重试机制
  3. 健康检查 nginx_upstream_check_module支持TCP心跳和HTTP心跳来实现健康检查

- 隔离之术
  1. 线程隔离
  2. 进程隔离--可以指不同的系统模块
  3. 集群隔离
  4. 机房隔离
  5. 读写隔离
  6. 动静隔离
  7. 爬虫隔离
  8. 热点隔离
  9. 资源隔离 读热点采用多级缓存，写热点采用缓存+队列模式消峰
  10. 使用Hystrix实现隔离

- 限流详解
  1. 限流算法，令牌桶，漏桶。计数器可以用来进行简单粗暴的限流
  2. 应用级限流 总并发，连接，请求数。限流某个接口的总并发数，或单位时间内的总请求数。Guava的Cache。RateLimiter。可以平滑限流
  3. 分布式限流 Redis+Lua ／ Nginx+Lua
  4. 接入层限流
  TODO


- 降级特技

- 超时与重试机制

- 回滚机制

- 压测与预案
