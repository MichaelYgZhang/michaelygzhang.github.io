<!DOCTYPE html>
<html>
  <head>
    <title>图解HTTP-9-10 – Michael – Developer</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="基于HTTP的功能追加协议，构建Web内容的技术" />
    <meta property="og:description" content="基于HTTP的功能追加协议，构建Web内容的技术" />
    
    <meta name="author" content="Michael" />

    
    <meta property="og:title" content="图解HTTP-9-10" />
    <meta property="twitter:title" content="图解HTTP-9-10" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Michael - Developer" href="/feed.xml" />
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css"/>
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="/images/favicon.ico" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Michael</a></h1>
            <p class="site-description">Developer</p>
          </div>

          <nav>
            <a href="/"><i class="fa fa-home fa-2x"></i></a>
            <a href="/category/cs"><i class="fa fa-tags fa-2x" aria-hidden="true"></i></a>
            <a href="/feed.xml" target="_blank"><i class="fa fa-feed fa-2x"></i></a>
            <a href="/about"><i class="fa fa-user-secret fa-2x"></i></a>
            <a href="/task"><i class="fa fa-book fa-2x" aria-hidden="true"></i></a>
          </nav>

          <a href="https://github.com/MichaelYgZhang" target="_blank">
            <img class="fork-me-on-github" src="/images/fork-me-on-github.png" alt="Fork me on GitHub">
          </a>
        </header>

        <div id="search-container">
          <input type="text" id="search-input" placeholder="search...">
          <ul id="results-container"></ul>
        </div>

      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <div class="post">
    <h1 class="post-title">图解HTTP-9-10</h1>
    <!--
    <span class="post-date">25 Sep 2016</span>
     |
    
    
    -->
    <article>
      <h4 id="http">9 基于HTTP的功能追加协议</h4>

<h5 id="spdy">SPDY的涉及与功能</h5>

<h5 id="spdy-1">SPDY设计</h5>

<p>SPDY是Google在2010年发布的取自SPeeDY，发音同speedy，开发目标旨在解决HTTP的新能瓶颈，缩短Web页面的家在时间(50%)</p>

<table>
  <thead>
    <tr>
      <th>HTTP</th>
      <th>应用层</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SPDY</td>
      <td>会话层</td>
    </tr>
    <tr>
      <td>SSL</td>
      <td>表示层</td>
    </tr>
    <tr>
      <td>TCP</td>
      <td>传输层</td>
    </tr>
  </tbody>
</table>

<p>使用SPDY后，HTTP协议额外获得以下功能:</p>
<ul>
  <li>多路复用流:通过单一的TCP连接，可以无限制处理多个HTTP请求，所有请求的处理都在一条TCP连接上完成，因此TCP的处理效率得到提高。</li>
  <li>赋予请求优先级:SPDY不仅可以无限制地并发处理请求，还可给请求逐个分配优先级顺序，主要为了在发送多个请求时，解决因宽带低而导致响应变慢的问题。</li>
  <li>压缩HTTP首部:压缩HTTP请求和响应的首部，通过过程产生的数量包和发送的字节数就少了。</li>
  <li>推送功能:支持服务器主动向客户端推送数据功能。这样，服务器可直接发送数据，而不必等待客户端的请求。</li>
  <li>服务器提示功能:服务器可以主动提示客户端请求所需资源，由于在客户端发现资源之前就可以获知资源的存在，因此在资源已经缓存的情况下，可以避免发送不必要的请求。</li>
</ul>

<h5 id="spdy-2">SPDY目前的缺陷</h5>

<p>SPDY基本上只是将单个域名(IP地址)的通信多路复用，所以当一个Web网站上使用多个域名下的资源，改善效就会受到限制。SPDY的确是一种可以有效消除HTTP瓶颈的技术，但很多Web网站存在的问题并非仅仅由HTTP瓶颈导致的，对Web本身的所读提升，还应该从其它可细致钻研的地方入手，比如改善Web内容的编写方式等。</p>

<h5 id="websocket">使用浏览器进行全双工通信的WebSocket</h5>

<p><code class="highlighter-rouge">WebSocket</code>为了解决Ajax和Comet里XMLHttpRequest附带的缺陷问题。一旦Web服务器与客户端之间建立起WebSocket协议的通信连接，之后所有的通信都依靠这个专用协议进行，通信过程中可互相发送JSON、XML、HTML或者图片等任意格式数据。由于是建立在HTTP基础上的协议，因此连接的发送方仍是客户端，而一旦确立WebSocket通信连接，不论服务器还是客户端，任意一方都可以直接向对方发送报文。</p>
<ul>
  <li>推送功能</li>
  <li>减少通信量:只要建立起WebSocket连接，就希望一直保持连接状态，和HTTP相比不但每次连接的总开销减少，而且由于WebSocket的首部信息很少，通信量也响应减少了。为了实现WebScoket通信，在建立HTTP连接后，需要完成一次”握手(Handshaking)”步骤。</li>
  <li>握手•请求:为了实现WebScoket通信，需要用到HTTP的Upgrade首部字段，告知服务器通信协议发生改变，以达到握手目的。</li>
</ul>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">GET</span> <span class="o">/</span><span class="nx">chat</span> <span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="nl">Host</span><span class="p">:</span> <span class="nx">server</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span>
<span class="nl">Upgrade</span><span class="p">:</span> <span class="nx">websocket</span>
<span class="nl">Connection</span><span class="p">:</span> <span class="nx">Upgrade</span>
<span class="nx">Sec</span><span class="o">-</span><span class="nx">WebScoket</span><span class="o">-</span><span class="nx">Key</span><span class="err">:</span> <span class="nx">dGEJKFLJDdfjl</span><span class="o">==</span>
<span class="nx">Origin</span><span class="err">:</span> <span class="nx">http</span><span class="err">:</span><span class="c1">//example.com</span>
<span class="nx">Sec</span><span class="o">-</span><span class="nx">WebSocket</span><span class="o">-</span><span class="nx">Protocol</span><span class="err">:</span> <span class="nx">chat</span><span class="p">,</span> <span class="nx">superchat</span>
<span class="nx">Sec</span><span class="o">-</span><span class="nx">WebSocket</span><span class="o">-</span><span class="nx">Version</span><span class="err">:</span> <span class="mi">13</span>
</code></pre>
</div>

<ul>
  <li>握手•响应:对于之前的请求返回101(Switching Proctocols)</li>
</ul>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">Http</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">101</span> <span class="nx">Switching</span> <span class="nx">Protocols</span>
<span class="nl">Upgrade</span><span class="p">:</span> <span class="nx">websocket</span>
<span class="nl">Connection</span><span class="p">:</span> <span class="nx">Upgrade</span>
<span class="nx">Sec</span><span class="o">-</span><span class="nx">WebSocket</span><span class="o">-</span><span class="nx">Accept</span><span class="err">:</span> <span class="nx">dGEJKFLJDdfjl</span><span class="o">==</span>
<span class="nx">Sec</span><span class="o">-</span><span class="nx">WebSocket</span><span class="o">-</span><span class="nx">Protocol</span><span class="err">:</span> <span class="nx">chat</span>
</code></pre>
</div>

<h5 id="websocket-api">WebSocket API</h5>

<p>JS可以调用<a href="http://www.w3.org/TR/websockets/">TheWebSocketAPI</a>
内部提供的程序API，实现WebSocket协议下全双工通信。
举例:每50ms发送一次数据实例！</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebScoket</span><span class="p">(</span><span class="s1">'ws:/game.example.com:12010/updates'</span><span class="p">);</span>
<span class="nx">scoket</span><span class="p">.</span><span class="nx">onopen</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">socket</span><span class="p">.</span><span class="nx">bufferedAmount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nx">socket</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">getUpdateDate</span><span class="p">());</span>
    <span class="p">},</span> <span class="mi">50</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<h5 id="http20">HTTP2.0</h5>

<p>设计的的7项技术,2.0的基础协议包括以下3项:</p>
<ul>
  <li>SPDY</li>
  <li>HTTP Speed + Mobility 由微软公司起草用于改善提高移动端痛通信时通信速度和性能的标准，建立在Google的SPDY和WebSocket之上</li>
  <li>Network-Friendly HTTP Upgrade主要是移动端通信时改善HTTP性能标准</li>
</ul>

<table>
  <thead>
    <tr>
      <th>压缩</th>
      <th>SPDY,Friendly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>多路复用</td>
      <td>SPDY</td>
    </tr>
    <tr>
      <td>TLS义务化</td>
      <td>Speed+Mobility</td>
    </tr>
    <tr>
      <td>协商</td>
      <td>Speed+Mobility,Friendly</td>
    </tr>
    <tr>
      <td>客户端拉拽(Client Pull)／服务器推送(Server Push)</td>
      <td>Speed+Mobility</td>
    </tr>
    <tr>
      <td>流量控制</td>
      <td>SPDY</td>
    </tr>
    <tr>
      <td>WebSocket</td>
      <td>Speed+Mobility</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>HTTP Speed + Mobility 简写Speed + Mobility, Network-Friendly HTTP Upgrade简写Friendly</p>
</blockquote>

<h4 id="webwebdav">Web服务器管理文件的WebDAV</h4>

<p>WebDAV(web-based Distributed Authoring and Versioning, 基于万维网的分布式创作和版本控制)是一个可以对Web服务器上的内容直接进行文件复制、编辑等操作的分布式文件系统。</p>

<p>针对服务器的资源WebDAV增加了一些概念:</p>
<ul>
  <li>集合(Collection):是一种统一管理过个资源的概念，以集合为单位可进行各种操作，也可实现类似集合的集合这样的叠加。</li>
  <li>资源(Resource):把文件货集合称为资源</li>
  <li>属性(Propertry):定义资源的属性。定义以”名称=值”的格式执行。</li>
  <li>锁(Lock):把文件设置成无状态编辑状态。多人同时编辑时，可防止在同一时间进行内容写入。</li>
</ul>

<h5 id="webdav">WebDAV内新增的方法及状态</h5>

<p>为实现远程文件管理，向HTTP/1.1中追加了以下方法及状态码</p>
<ul>
  <li>PROPFIND:获取属性</li>
  <li>PROPPATCH:修改属性</li>
  <li>MKCOL:创建集合</li>
  <li>COPY:复制资源及属性</li>
  <li>MOVE:移动资源</li>
  <li>LOCK:资源加锁</li>
  <li>UNLOCK:资源解锁</li>
  <li>102 Processing:可正常处理请求，目前处理中状态</li>
  <li>207 Multi-Status:存在多种状态</li>
  <li>422 Unprocessible Entity:格式正确，内容错误</li>
  <li>423 Locked:资源已经加锁</li>
  <li>424 Failed Dependency:处理与某请求关联的请求失败，因此不再维持依赖关系</li>
  <li>507 Insufficient Storage:保存空间不足</li>
</ul>

<h4 id="web">10 构建Web内容技术</h4>

<ul>
  <li>HTML(HyperText Markup Language,超文本标记语言)</li>
  <li>CSS(Cascading Style Shets,层叠样式表)</li>
  <li>动态HTML(Dynamic HTML)即使用客户端脚本语言将静态HTML内容编程动态技术的总称。使用js实现对HTML的Web页面动态改造，利用DOM(Document Object Model,文档对象模型)可以指定欲发送动态变化的HTML元素。</li>
</ul>

<h5 id="web-1">Web应用</h5>

<ul>
  <li>CGI(Common Gateway Interface,通用网关接口),每次请求都启动新的CGI程序，当访问比较大时服务器负载大</li>
  <li>Servelt 取自Server + Applet</li>
</ul>

<h5 id="section">数据发布的格式及语言</h5>

<ul>
  <li>XML(eXtensible Markup Language,可扩展标记语言)</li>
  <li>RSS／Atom</li>
  <li>JSON(JavaScript Object Notatin)能够处理数据类型有7种:
    <blockquote>
      <p>fasle/null/true/对象/数组/数字/字符串</p>
    </blockquote>
  </li>
</ul>

    </article>
  </div>

  <div class="related">
    <h4>最新文章</h4>
    <ul class="related-posts">
      
        <li>
          <h5>
            <a href="/cs/2016/09/27/HTTP%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97-3.html">
              HTTP权威指南-3
              <small>2016-09-27</small>
            </a>
          </h5>
        </li>
      
        <li>
          <h5>
            <a href="/cs/2016/09/25/%E9%BB%91%E5%AE%A2%E4%B8%8E%E7%94%BB%E5%AE%B6%E7%AC%94%E8%AE%B0.html">
              黑客与画家-读书笔记
              <small>2016-09-25</small>
            </a>
          </h5>
        </li>
      
        <li>
          <h5>
            <a href="/mysql/2016/09/25/%E9%AB%98%E6%80%A7%E8%83%BDmysql-4.html">
              高性能mysql读书笔记
              <small>2016-09-25</small>
            </a>
          </h5>
        </li>
      
    </ul>
  </div>

  
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'michaelygzhangblog';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:g.zhangyg@gmail.com"><i class="svg-icon email"></i></a>


<a href="https://github.com/MichaelYgZhang"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/michaelygzhang"><i class="svg-icon twitter"></i></a>


<a href="https://plus.google.com/115646538142388831563"><i class="svg-icon googleplus"></i></a>

        </footer>
      </div>
    </div>

    <div id="backToTop" class="backtoTop">
    	<i class="fa fa-hand-o-up fa-2x"></i>
    </div>

    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-84531968-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/cs/2016/09/25/%E5%9B%BE%E8%A7%A3HTTP-9-10.html',
		  'title': '图解HTTP-9-10'
		});
	</script>
	<!-- End Google Analytics -->


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simple-jekyll-search/1.1.5/jekyll-search.js" type="text/javascript"></script>
    <script src="/js/blog.js" type="text/javascript"></script>

    <script type="text/javascript">
          SimpleJekyllSearch({
            searchInput: document.getElementById('search-input'),
            resultsContainer: document.getElementById('results-container'),
            json: '/search.json',
            searchResultTemplate: '<li><a href="{url}" title="{desc}">{title}</a></li>',
            noResultsText: 'No results found',
            limit: 10,
            fuzzy: false,
            exclude: ['Welcome']
          })
    </script>
  </body>
</html>
